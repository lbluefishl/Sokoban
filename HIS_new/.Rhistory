contrasts <- emmeans(model2_final, ~ condition | level) %>%
pairs(adjust="none")
contrasts
cohens_d(contrasts)
d_table <- effectsize(contrasts)
sigma(model2_final)
contrast$estimate / 35.8
eff_size(contrasts)
eff_size(contrasts, edf = Inf)
eff_size(contrasts, sigma = sigma(contrasts), edf = Inf)
eff_size(contrasts, sigma = sigma(contrasts), edf = 20)
eff_size(contrasts, sigma = sigma(contrasts), edf = 20, method = "identity")
eff_size(pairs(contrasts), sigma = sigma(contrasts), edf = 20, method = "identity")
contrast_results <- emmeans(model2_final, ~ condition | level)
eff_size(contrast_results)
emm <- emmeans(model2_final, ~ condition | level)
# Compute effect sizes, using residual SD from the model
eff_size(emm, sigma = sigma(model2_final), edf = df.residual(model2_final))
eff_size(contrasts, sigma = sigma(model2_final), edf = df.residual(model2_final))
eff_size(emm, sigma = sigma(model2_final), edf = df.residual(model2_final))
emm
contrasts
eff_size(emm, sigma = sigma(model2_final), edf = df.residual(model2_final))
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(lme4, tidyverse, psych, lmerTest, ggeffects, rmarkdown, jsonlite, cluster, MuMIn, emmeans, effectsize)
data$allMovesets <- Map(c, data$beforeBreakMovesets, data$afterBreakMovesets)
get_cleaned_movesets <- function(level_name) {
level_rows <- data[data$level == level_name, ]
combined_movesets <- unlist(level_rows$allMovesets, use.names = FALSE)
filtered <- combined_movesets[nchar(combined_movesets) >= 4]
unique(filtered)
}
easy_movesets   <- get_cleaned_movesets("easy")
medium_movesets <- get_cleaned_movesets("medium")
hard_movesets   <- get_cleaned_movesets("hard")
hard_movesets <- gsub("rrddllu", "z", hard_movesets)
hard_movesets <- gsub("drruull", "x", hard_movesets)
prefix_distance <- function(a, b) {
min_len <- min(nchar(a), nchar(b))
match_length <- 0
for (i in seq_len(min_len)) {
if (substr(a, i, i) != substr(b, i, i)) break
match_length <- match_length + 1
}
return(1 - (match_length / min_len))
}
build_prefix_dist_matrix <- function(movesets) {
n <- length(movesets)
dist_mat <- matrix(0, n, n)
for (i in 1:(n-1)) {
for (j in (i+1):n) {
d <- prefix_distance(movesets[i], movesets[j])
dist_mat[i, j] <- d
dist_mat[j, i] <- d
}
}
as.dist(dist_mat)
}
easy_dist <- build_prefix_dist_matrix(easy_movesets)
medium_dist <- build_prefix_dist_matrix(medium_movesets)
hard_dist <- build_prefix_dist_matrix(hard_movesets)
easy_clust <- hclust(easy_dist, method = "complete")
medium_clust <- hclust(medium_dist, method = "complete")
hard_clust <- hclust(hard_dist, method = "complete")
avg_sil <- sapply(5:30, function(k) {
clusters <- cutree(easy_clust, k)
sil <- silhouette(clusters, easy_dist)
mean(sil[, 3])
})
plot(5:30, avg_sil, type = "b",
xlab = "Number of clusters", ylab = "Average silhouette width")
avg_sil <- sapply(5:30, function(k) {
clusters <- cutree(medium_clust, k)
sil <- silhouette(clusters, medium_dist)
mean(sil[, 3])
})
plot(5:30, avg_sil, type = "b",
xlab = "Number of clusters", ylab = "Average silhouette width")
avg_sil <- sapply(5:30, function(k) {
clusters <- cutree(hard_clust, k)
sil <- silhouette(clusters, hard_dist)
mean(sil[, 3])
})
plot(5:30, avg_sil, type = "b",
xlab = "Number of clusters", ylab = "Average silhouette width")
clusters_easy <- cutree(easy_clust, k = 19)
clusters_medium <- cutree(medium_clust, k = 17)
clusters_hard <- cutree(hard_clust, k = 15)
main_data$beforeBreakMovesets <- mapply(function(moves, level) {
moves <- moves[nchar(moves) >= 4]
if (level == "hard") {
moves <- gsub("rrddllu", "z", moves)
moves <- gsub("drruull", "x", moves)
}
return(moves)
}, main_data$beforeBreakMovesets, main_data$level, SIMPLIFY = FALSE)
main_data$afterBreakMovesets <- mapply(function(moves, level) {
moves <- moves[nchar(moves) >= 4]
if (level == "hard") {
moves <- gsub("rrddllu", "z", moves)
moves <- gsub("drruull", "x", moves)
}
return(moves)
}, main_data$afterBreakMovesets, main_data$level, SIMPLIFY = FALSE)
moveset_data <- main_data[
lengths(main_data$beforeBreakMovesets) > 0 &
lengths(main_data$afterBreakMovesets) > 0,
]
lookup_easy <- setNames(clusters_easy, easy_movesets)
lookup_medium <- setNames(clusters_medium, medium_movesets)
lookup_hard <- setNames(clusters_hard, hard_movesets)
map_moves_to_clusters <- function(moves, level) {
level <- as.character(level)
lookup <- switch(level,
"easy" = lookup_easy,
"medium" = lookup_medium,
"hard" = lookup_hard)
sapply(moves, function(m) lookup[[m]], USE.NAMES = FALSE)
}
moveset_data$beforeClusters <- mapply(map_moves_to_clusters,
moveset_data$beforeBreakMovesets,
moveset_data$level,
SIMPLIFY = FALSE)
moveset_data$afterClusters <- mapply(map_moves_to_clusters,
moveset_data$afterBreakMovesets,
moveset_data$level,
SIMPLIFY = FALSE)
moveset_data$newMove <- mapply(function(before, after) {
first_after <- after[1]
if (first_after %in% before) 0 else 1
}, moveset_data$beforeClusters, moveset_data$afterClusters)
moveset_data$firstNewMove <- mapply(function(before, after) {
if (after[1] == before[1]) 0 else 1
}, moveset_data$beforeClusters, moveset_data$afterClusters)
moveset_data$beforeBreakLength <- sapply(moveset_data$beforeBreakMovesets, length)
model3_base <- glmer(newMove ~  level * condition + beforeBreakLength + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
summary(model3_base)
r.squaredGLMM(model3_base)
confint(model3_base, method = "Wald")
emmeans(model3_base, ~ condition | level) %>%
pairs(adjust="none")
preds <- ggpredict(model3_base, terms = c("level", "condition"))
ggplot(preds, aes(x = x, y = predicted, color = group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2) +
geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = group), alpha = 0.2, color = NA) +
labs(
x = "Level",
y = "Predicted Probability of New Move",
color = "Condition",
fill = "Condition"
) +
theme_minimal()
View(moveset_data)
moveset_data$beforeBreakLength
model3_base <- glmer(newMove ~  level * condition + beforeBreakLength + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
model3_noint <- glmer(newMove ~  level + condition + beforeBreakLength + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
anova(model3_base,model3_noint)
model3_nocov <- glmer(newMove ~  level + condition + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
anova(model3_base,model3_nocov)
model3_sex <- glmer(newMove ~  level * condition + beforeBreakLength + sex + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
anova(model3_base,model3_sex)
moveset_data$sex
counts <- table(clusters_easy)
props <- counts / length(clusters_easy)
easy_prop <- data.frame(
cluster = names(counts),
proportion = round(as.numeric(props) * 100, 2)
)
print(easy_prop)
counts <- table(clusters_medium)
props <- counts / length(clusters_medium)
medium_prop <- data.frame(
cluster = names(counts),
proportion = round(as.numeric(props) * 100, 2)
)
print(medium_prop)
counts <- table(clusters_hard)
props <- counts / length(clusters_hard)
hard_prop <- data.frame(
cluster = names(counts),
proportion = round(as.numeric(props) * 100, 2)
)
print(hard_prop)
clusters_easy <- cutree(easy_clust, k = 12)
clusters_medium <- cutree(medium_clust, k = 17)
clusters_hard <- cutree(hard_clust, k = 11)
main_data$beforeBreakMovesets <- mapply(function(moves, level) {
moves <- moves[nchar(moves) >= 4]
if (level == "hard") {
moves <- gsub("rrddllu", "z", moves)
moves <- gsub("drruull", "x", moves)
}
return(moves)
}, main_data$beforeBreakMovesets, main_data$level, SIMPLIFY = FALSE)
main_data$afterBreakMovesets <- mapply(function(moves, level) {
moves <- moves[nchar(moves) >= 4]
if (level == "hard") {
moves <- gsub("rrddllu", "z", moves)
moves <- gsub("drruull", "x", moves)
}
return(moves)
}, main_data$afterBreakMovesets, main_data$level, SIMPLIFY = FALSE)
moveset_data <- main_data[
lengths(main_data$beforeBreakMovesets) > 0 &
lengths(main_data$afterBreakMovesets) > 0,
]
lookup_easy <- setNames(clusters_easy, easy_movesets)
lookup_medium <- setNames(clusters_medium, medium_movesets)
lookup_hard <- setNames(clusters_hard, hard_movesets)
map_moves_to_clusters <- function(moves, level) {
level <- as.character(level)
lookup <- switch(level,
"easy" = lookup_easy,
"medium" = lookup_medium,
"hard" = lookup_hard)
sapply(moves, function(m) lookup[[m]], USE.NAMES = FALSE)
}
moveset_data$beforeClusters <- mapply(map_moves_to_clusters,
moveset_data$beforeBreakMovesets,
moveset_data$level,
SIMPLIFY = FALSE)
moveset_data$afterClusters <- mapply(map_moves_to_clusters,
moveset_data$afterBreakMovesets,
moveset_data$level,
SIMPLIFY = FALSE)
moveset_data$newMove <- mapply(function(before, after) {
first_after <- after[1]
if (first_after %in% before) 0 else 1
}, moveset_data$beforeClusters, moveset_data$afterClusters)
moveset_data$firstNewMove <- mapply(function(before, after) {
if (after[1] == before[1]) 0 else 1
}, moveset_data$beforeClusters, moveset_data$afterClusters)
moveset_data$beforeBreakLength <- sapply(moveset_data$beforeBreakMovesets, length)
model3_base <- glmer(newMove ~  level * condition + beforeBreakLength + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
summary(model3_base)
r.squaredGLMM(model3_base)
confint(model3_base, method = "Wald")
emmeans(model3_base, ~ condition | level) %>%
pairs(adjust="none")
preds <- ggpredict(model3_base, terms = c("level", "condition"))
ggplot(preds, aes(x = x, y = predicted, color = group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2) +
geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = group), alpha = 0.2, color = NA) +
labs(
x = "Level",
y = "Predicted Probability of New Move",
color = "Condition",
fill = "Condition"
) +
theme_minimal()
exp(fixef(model3_base))
exp(confint(model3_base, parm = "beta_", method="Wald"))
model3_base <- glmer(newMove ~  level * condition + beforeBreakLength + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
summary(model3_base)
r.squaredGLMM(model3_base)
confint(model3_base, method = "Wald")
exp(fixef(model3_base))
exp(confint(model3_base, parm = "beta_", method="Wald"))
emmeans(model3_base, ~ condition | level) %>%
pairs(adjust="none")
preds <- ggpredict(model3_base, terms = c("level", "condition"))
plot3 <- ggplot(preds, aes(x = group, y = predicted)) +
geom_point(size = 2.5) +
geom_errorbar(
aes(ymin = conf.low, ymax = conf.high),
width = 0.15,
linewidth = 0.6
) +
facet_wrap(~ x, nrow = 1) +
labs(
x = "",
y = "New Move Likelihood"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),          # remove grid
strip.text = element_text(face = "bold"),
axis.line = element_line(linewidth = 0.6, color = "black"),  # add x and y axis lines
axis.ticks = element_line(linewidth = 0.6)
)
ggsave(
filename = "solutionTime.pdf",
plot = plot2,
width = 7,
height = 3,
units = "in"
)
ggplot(preds, aes(x = x, y = predicted, color = group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2) +
geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = group), alpha = 0.2, color = NA) +
labs(
x = "Level",
y = "Predicted Probability of New Move",
color = "Condition",
fill = "Condition"
) +
theme_minimal()
model3_base <- glmer(newMove ~  level * condition + beforeBreakLength + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
summary(model3_base)
r.squaredGLMM(model3_base)
confint(model3_base, method = "Wald")
exp(fixef(model3_base))
exp(confint(model3_base, parm = "beta_", method="Wald"))
emmeans(model3_base, ~ condition | level) %>%
pairs(adjust="none")
preds <- ggpredict(model3_base, terms = c("level", "condition"))
plot3 <- ggplot(preds, aes(x = group, y = predicted)) +
geom_point(size = 2.5) +
geom_errorbar(
aes(ymin = conf.low, ymax = conf.high),
width = 0.15,
linewidth = 0.6
) +
facet_wrap(~ x, nrow = 1) +
labs(
x = "",
y = "New Move Likelihood"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),          # remove grid
strip.text = element_text(face = "bold"),
axis.line = element_line(linewidth = 0.6, color = "black"),  # add x and y axis lines
axis.ticks = element_line(linewidth = 0.6)
)
ggsave(
filename = "newMove.pdf",
plot = plot3,
width = 7,
height = 3,
units = "in"
)
plot3
plot2
plot3
plogis(1.83)
emm <- emmeans(model3_base, ~ condition | level)
eff_size(emm, sigma = sigma(model3_base), edf = df.residual(model3_base))
emmeans(model3_base, ~ condition | level) %>%
pairs(adjust="none")
exp(0.66)
emmeans(model3_base, ~ condition | level, type = "response") %>%
pairs(adjust="none")
emm <- emmeans(model3_base, ~ condition | level, type = "response")
emm
emmeans(model3_base, ~ condition | level)
plogis(.361)
View(moveset_data)
write.csv(moveset_data[,c("condition", "level", "newMove")], "test.csv")
model3_base <- glmer(newMove ~  level * condition + beforeBreakLength + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
summary(model3_base)
r.squaredGLMM(model3_base)
confint(model3_base, method = "Wald")
exp(fixef(model3_base))
exp(confint(model3_base, parm = "beta_", method="Wald"))
emmeans(model3_base, ~ condition | level, type = "response")
emmeans(model3_base, ~ condition | level, type = "response") %>%
pairs(adjust="none")
preds <- ggpredict(model3_base, terms = c("level", "condition"), tyep = "re")
plot3 <- ggplot(preds, aes(x = group, y = predicted)) +
geom_point(size = 2.5) +
geom_errorbar(
aes(ymin = conf.low, ymax = conf.high),
width = 0.15,
linewidth = 0.6
) +
facet_wrap(~ x, nrow = 1) +
labs(
x = "",
y = "New Move Likelihood"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),          # remove grid
strip.text = element_text(face = "bold"),
axis.line = element_line(linewidth = 0.6, color = "black"),  # add x and y axis lines
axis.ticks = element_line(linewidth = 0.6)
)
ggsave(
filename = "newMove.pdf",
plot = plot3,
width = 7,
height = 3,
units = "in"
)
plot3
model3_base <- glmer(newMove ~  level * condition + beforeBreakLength + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
summary(model3_base)
r.squaredGLMM(model3_base)
confint(model3_base, method = "Wald")
exp(fixef(model3_base))
exp(confint(model3_base, parm = "beta_", method="Wald"))
emmeans(model3_base, ~ condition | level, type = "response")
emmeans(model3_base, ~ condition | level, type = "response") %>%
pairs(adjust="none")
preds <- ggpredict(model3_base, terms = c("level", "condition"), type = "re")
model3_base <- glmer(newMove ~  level * condition + beforeBreakLength + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
summary(model3_base)
r.squaredGLMM(model3_base)
confint(model3_base, method = "Wald")
exp(fixef(model3_base))
exp(confint(model3_base, parm = "beta_", method="Wald"))
emmeans(model3_base, ~ condition | level, type = "response")
emmeans(model3_base, ~ condition | level, type = "response") %>%
pairs(adjust="none")
preds <- ggpredict(model3_base, terms = c("level", "condition"), type = "random")
plot3 <- ggplot(preds, aes(x = group, y = predicted)) +
geom_point(size = 2.5) +
geom_errorbar(
aes(ymin = conf.low, ymax = conf.high),
width = 0.15,
linewidth = 0.6
) +
facet_wrap(~ x, nrow = 1) +
labs(
x = "",
y = "New Move Likelihood"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),          # remove grid
strip.text = element_text(face = "bold"),
axis.line = element_line(linewidth = 0.6, color = "black"),  # add x and y axis lines
axis.ticks = element_line(linewidth = 0.6)
)
ggsave(
filename = "newMove.pdf",
plot = plot3,
width = 7,
height = 3,
units = "in"
)
plot3
?ggpredict
model3_base <- glmer(newMove ~  level * condition + beforeBreakLength + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
summary(model3_base)
r.squaredGLMM(model3_base)
confint(model3_base, method = "Wald")
exp(fixef(model3_base))
exp(confint(model3_base, parm = "beta_", method="Wald"))
emmeans(model3_base, ~ condition | level, type = "response")
emmeans(model3_base, ~ condition | level, type = "response") %>%
pairs(adjust="none")
preds <- ggpredict(model3_base, terms = c("level", "condition", "prolificPID"), type = "random")
plot3 <- ggplot(preds, aes(x = group, y = predicted)) +
geom_point(size = 2.5) +
geom_errorbar(
aes(ymin = conf.low, ymax = conf.high),
width = 0.15,
linewidth = 0.6
) +
facet_wrap(~ x, nrow = 1) +
labs(
x = "",
y = "New Move Likelihood"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),          # remove grid
strip.text = element_text(face = "bold"),
axis.line = element_line(linewidth = 0.6, color = "black"),  # add x and y axis lines
axis.ticks = element_line(linewidth = 0.6)
)
ggsave(
filename = "newMove.pdf",
plot = plot3,
width = 7,
height = 3,
units = "in"
)
plot3
model3_base <- glmer(newMove ~  level * condition + beforeBreakLength + (1|prolificPID), family="binomial", control = glmerControl(optimizer = "bobyqa"), data = moveset_data)
summary(model3_base)
r.squaredGLMM(model3_base)
confint(model3_base, method = "Wald")
exp(fixef(model3_base))
exp(confint(model3_base, parm = "beta_", method="Wald"))
emmeans(model3_base, ~ condition | level, type = "response")
emmeans(model3_base, ~ condition | level, type = "response") %>%
pairs(adjust="none")
preds <- ggpredict(model3_base, terms = c("level", "condition"))
plot3 <- ggplot(preds, aes(x = group, y = predicted)) +
geom_point(size = 2.5) +
geom_errorbar(
aes(ymin = conf.low, ymax = conf.high),
width = 0.15,
linewidth = 0.6
) +
facet_wrap(~ x, nrow = 1) +
labs(
x = "",
y = "New Move Likelihood"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid = element_blank(),          # remove grid
strip.text = element_text(face = "bold"),
axis.line = element_line(linewidth = 0.6, color = "black"),  # add x and y axis lines
axis.ticks = element_line(linewidth = 0.6)
)
ggsave(
filename = "newMove.pdf",
plot = plot3,
width = 7,
height = 3,
units = "in"
)
plot3
R.version.string
